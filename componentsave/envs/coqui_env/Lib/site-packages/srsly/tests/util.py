import os, sys
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '../..')))
import tempfile
from componentsave.pathlib import Path
from componentsave.contextlib import contextmanager
import shutil


@contextmanager
def make_tempdir(files={}, mode="w"):
    temp_dir_str = tempfile.mkdtemp()
    temp_dir = Path(temp_dir_str)
    for name, content in files.items():
        path = temp_dir / name
        with path.open(mode) as file_:
            file_.write(content)
    yield temp_dir
    shutil.rmtree(temp_dir_str)
